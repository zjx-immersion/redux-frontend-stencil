!function(t){"use strict";var i=function(i){bg.IntroTutorial.getState(function(o){if(o.enabled&&document.location.host.toLowerCase().includes(o.domain)){var e=o.isInContext?t.InContextIntroTutorialDialogOptions:t.VaultIntroTutorialDialogOptions;i(o,e)}})};Topics.get(Topics.SITE_NOTIFICATION_STATE).subscribe(function(t){function o(t){n&&t&&LPFrame.css({id:n.getDialogID(),css:{top:t.top+40,left:t.left+380}})}function e(t){n?(Topics.get(Topics.INFIELD_FRAME_POSITION_CHANGED).unsubscribe(o),bg.IntroTutorial.getState(function(i){"add_first_site"!==i.inContextOnboardingStep&&(n.close(!0),n=null,t&&t())})):t&&t()}var n=null;i(function(t,i){var o=LPSiteService.getSite(t.domain);if(o.isLoggedIn(document)){if(bg.IntroTutorial.setState({firstLogin:!1}),!LPFrame.hasDialogs()&&(n=t.isLoginTheLastPassWay?LPFrame.openDialog(i.name,{addHide:!0,textChoice:"loginTheLastPassWay",arrow:i.getArrowOptions()},{css:i.getCssOptions()}):LPFrame.openDialog(i.name,{addHide:!0,textChoice:"siteLanding",arrow:i.getArrowOptions()},{css:i.getCssOptions()}))){var e=i.getTrackElementOptions();e.element=o.getTrackingEl(document),n.trackElement(e)}}else t.firstLogin&&o.logMeOut(document,i.name)}),Topics.get(Topics.SITE_NOTIFICATION).subscribe(function(o){i(function(i,e){bg.IntroTutorial.setState({inContextOnboardingStep:"add_site_to_lastpass"}),setTimeout(function(){bg.sendLpImprove("onboardingtour::displayed_onboarding_save_a_site",{version:"incontext"}),o.getInterface().LPDialog.openDialog(e.name,{addHide:!0,modal:!0,siteName:t.defaultData.name,textChoice:"saveSite",parentDialog:"contentScriptSite",css:{position:"absolute",top:"100%","margin-top":"10px","margin-right":0,right:0},arrow:{orientation:"top",positionTarget:"#submit"}})},1e3)})}),Topics.get(Topics.INFIELD_NOTIFICATION_OPENED).subscribe(function(t){i(function(i,s){e(function(){var e=i.inContextOnboardingStep;e&&"add_first_site"!==e&&(n=LPFrame.openDialog(s.name,{addHide:!0,textChoice:"selectYourSite",arrow:s.getArrowOptions()},{css:{width:"auto",height:"auto","min-width":"168px"}})),Topics.get(Topics.INFIELD_FRAME_POSITION_CHANGED).subscribe(o),o(t)})})}),Topics.get(Topics.INFIELD_NOTIFICATION_FILLED).subscribe(function(){i(function(t,i){t.enabled&&(bg.IntroTutorial.setState({isLoginTheLastPassWay:!1}),bg.IntroTutorial.completeTutorial({textChoice:"completed",siteName:t.domain}))})}),Topics.get(Topics.INFIELD_NOTIFICATION_CLOSED).subscribe(function(){i(function(t,i){e()})})})}(IntroTutorialDialogOptions);
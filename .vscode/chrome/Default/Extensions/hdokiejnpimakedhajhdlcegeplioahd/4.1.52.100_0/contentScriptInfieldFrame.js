function LP_keypress_handler(e){"use strict";return 27==e.keyCode?void LPInfieldFrame.close("close"):9==e.keyCode?void LPInfieldFrame.close("away"):void 0}var lpResizeEvent=function(){"use strict";function e(){o||(o=setTimeout(function(){o=null,t()},66))}function t(){l&&l()}function n(t){l=t,window.addEventListener("resize",e)}function i(){l=null,window.removeEventListener("resize",e)}var o,l;return{attachWindowResizeEvent:n,detachWindowResizeEvent:i}}(),LPInfieldFrame=function(){"use strict";function e(e,t){var n;return function(){var i=this,o=arguments;clearTimeout(n),n=setTimeout(function(){n=null,e.apply(i,o)},t)}}function t(t){(w=w||e(n,100))(t)}function n(e){if(v)return void(v=!1);if(e.iframe&&!e.fieldEl)try{e.fieldEl=$(e.iframe).contents().find("#"+e.id)[0]}catch(e){}if(e&&("focus"!==e.eventType||!E)){if(u){if(p.id===e.id)return;o("away")}!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(m="betterContentScriptPopup.html"),e.url=m,p=e,u=LPFrame.openFrame({url:m,interfaceDefinition:Interfaces.InfieldPopupInterface}),c(),a(),lpResizeEvent.attachWindowResizeEvent(a),window.addEventListener("click",i,!0),bg.sendLpImprove("newinfieldopen",{source:"formv2",option:e.eventType})}}function i(e){return(!p||e.target.id!==p.id&&e.target!==p.fieldEl)&&(o("away"),!0)}function o(e){u&&(e&&(v="action"==e,bg.sendLpImprove("newinfieldclose",{source:"formv2",option:e}),"close"===e&&(E=!0,p.fieldEl&&(LP_addEventHandler(p.fieldEl,"click",launchPopup,!1),realLaunchPopup&&p.fieldEl.removeEventListener("focus",realLaunchPopup)))),window.removeEventListener("click",i),lpResizeEvent.detachWindowResizeEvent(),u&&(u.close(),Topics.publish(Topics.INFIELD_NOTIFICATION_CLOSED)),u=null,p=null)}function l(e,t){var n={};return e&&(n.height=e),t&&(n.width=t),n}function r(e){var t={top:0,left:0};if(e){var n={top:0,left:0};e.iframe&&(n=e.iframe.getBoundingClientRect());var i={bottom:parseInt(e.posy),left:parseInt(e.posx),width:e.width};e.fieldEl&&e.fieldEl.getBoundingClientRect?i=e.fieldEl.getBoundingClientRect():e.fieldBox&&(i=e.fieldBox),t.top=window.pageYOffset+n.top+i.bottom,t.left=window.pageXOffset+n.left+i.left+i.width-375,t.left<=0&&(t.left=window.pageXOffset+n.left+i.left-10)}return t}function f(e){u&&u.getInterface().lpInfield.setArrowPosition({position:e})}function c(){u&&u.css({display:"block",position:"absolute",height:"0px"})}function s(e,t){u&&u.css(l(e,t))}function a(e){var t=null;p.fieldEl&&!$(p.fieldEl).is(":visible")?o():u&&(t=r(p),f(t.left<=0?25:360),u.css(t),e&&"function"==typeof e&&e(t),csTop.Topics.publish(Topics.INFIELD_FRAME_POSITION_CHANGED,t))}function d(e,t,n){(e==punycode.URLToASCII(document.location.href)||has_same_tld(e,document.location.href))&&populategeneratedpassword(e,t,n)}var u,p,v,w,m="contentScriptPopup.html",E=!1;return{close:o,show:c,openFrame:t,resizeFrame:s,positionFrame:a,fillGeneratedPassword:d}}();
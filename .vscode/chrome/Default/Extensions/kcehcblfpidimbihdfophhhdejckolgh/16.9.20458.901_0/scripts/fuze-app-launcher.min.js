function fuzeLog(e){var t=document.getElementById("FuzeSWF");if(t)t.log("PluginDetect.js: "+e);else{var n=document.getElementById("Detector");n&&n.log("PluginDetect.js: "+e)}}function startShareNative(e){var t=-1;fuzeLog("startShareNative() "+e);try{pluginFuzeShare||detectFUZEScreenSharing(),t=pluginFuzeShare.StartNative(e),fuzeLog("Native Screen Share start result code: "+t),void 0==t&&(t=1e3)}catch(n){fuzeLog("startShareNative Exception: "+n.message),t=-1}return pluginFound||(t=-2),t}function detectFUZEScreenSharing(e){try{-1!=navigator.userAgent.indexOf("Firefox")?fuzeLog("detectFUZEScreenSharing Firefox"):-1!=navigator.userAgent.indexOf("MSIE")&&(fuzeLog("detectFUZEScreenSharing(MSIE) started"),!pluginFound&&detectableWithVB&&(fuzeLog("detectActiveXControl start: FUZEShareManager"+e+".IEFuzeExtension"+e+".1"),pluginFound=detectActiveXControl("FUZEShareManager"+e+".IEFuzeExtension"+e+".1"),fuzeLog("pluginFound: "+pluginFound)))}catch(t){fuzeLog("detectFUZEScreenSharing Exception: "+t.message)}return pluginFound}function log_DoFSCommand(e){fuzeLog("VBscript Exception: "+e)}var detectableWithVB=!1,pluginFound=!1,pluginFuzeShare=null,javaAppletParam;-1!=navigator.userAgent.indexOf("MSIE")&&-1!=navigator.userAgent.indexOf("Win")&&(document.writeln('<script language="VBscript">'),document.writeln("'do a one-time test for a version of VBScript that can handle this code"),document.writeln("  detectableWithVB = False"),document.writeln("  If ScriptEngineMajorVersion >= 2 then"),document.writeln("      detectableWithVB = True"),document.writeln("  End If"),document.writeln("'this next function will detect most plugins"),document.writeln("  Function detectActiveXControl(activeXControlName)"),document.writeln("      on error resume next"),document.writeln("      detectActiveXControl = False"),document.writeln("      If detectableWithVB Then"),document.writeln("          Set pluginFuzeShare = CreateObject(activeXControlName)"),document.writeln("          If Err = 0 Then"),document.writeln("              detectActiveXControl = IsObject(pluginFuzeShare)"),document.writeln("              If Err <> 0 Then"),document.writeln("                  LogErrorInfo"),document.writeln("              End If"),document.writeln("          Else"),document.writeln("              LogErrorInfo"),document.writeln("          End If"),document.writeln("      End If"),document.writeln("  End Function"),document.writeln("  Sub LogErrorInfo"),document.writeln("      errNumber = Err.number"),document.writeln("      errDescription = Err.description"),document.writeln('      call log_DoFSCommand("Error number " & errNumber & ": " + errDescription)'),document.writeln("  End Sub"),document.writeln("</script>")),FuzeAppLauncher=function(){var e={init:function(){this.browser=this.searchString(this.dataBrowser,!0)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e,t){if(t&&navigator.appVersion.indexOf("Trident/")>0)return"Explorer";for(var n=0;n<e.length;n++){var r=e[n].string,i=e[n].prop;if(this.versionSearchString=e[n].versionSearch||e[n].identity,r){if(-1!=r.indexOf(e[n].subString))return e[n].identity}else if(i)return e[n].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},t={init:function(){e.init()},joinMeetingWithNativeApp:function(n){if("Explorer"===e.browser)(!detectFUZEScreenSharing()||startShareNative()<=0)&&t.launchWithProtocol(n.url);else{null!=navigator.plugins&&navigator.plugins.refresh(!1);for(var r=null,i=0;i<navigator.plugins.length;i++)for(var o=navigator.plugins[i],a=0;a<o.length;a++){var u=o[a]&&o[a].type?o[a].type:"";0==u.indexOf("application/x-fuzeshare-plugin")&&(r=u)}if(r)try{if(!document.getElementById("NPAPI_plugin")){var s=document.createElement("div");s.id="NPAPI_plugin",s.innerHTML='<embed id="fuze_plugin" type="'+u+'" width=0 height=0/>',document.body.appendChild(s)}document.getElementById("fuze_plugin").StartNative(n.url)}catch(c){t.launchWithProtocol(n.url)}else("Edge"===e.browser||"Chrome"===e.browser)&&t.launchWithProtocol(n.url)}},launchWithProtocol:function(t){var n=document.createElement("a");n.href=t||window.location.href,n.protocol="fuze:";var r=n.href;if("Chrome"==e.browser)setTimeout(function(){window.location.assign(r)},1);else{var i=$("<iframe>").css({position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}).attr("src",r);i.appendTo(document.body)}},isUnsupportedOS:function(){var t=!1,n=!0;if("Windows"===e.OS){var r=/windows\snt\s(\d{1,2}\.\d+)/i.exec(navigator.userAgent);n=!!(r&&parseFloat(r[1])>6)}else if("Mac"===e.OS){var i=null,o=/Mac OS X (\d+)[\._](\d+)[\._]?(\d+)?/,r=o.exec(navigator.userAgent);r&&r.length&&(i={major:parseInt(r[1]),minor:parseInt(r[2]),patch:parseInt(r[3]||0)}),i&&(t=i.major>10?!1:10==i.major&&(i.minor>8||8==i.minor&&i.patch>5)?!1:!0)}return t||!n}};return t.init(),{JoinMeetingWithNativeApp:function(e){return t.joinMeetingWithNativeApp(e)},IsUnsupportedOS:function(){return t.isUnsupportedOS()}}}();